# =========================================================================== #
# NG CMS // Плагины // Форум                                    #
# =========================================================================== #

Плагин отображает на сайте информационный блок с RSS канала других сайтов.

--------------------------------------------------------------------

  
### Изменения от KachalkinGeorg
  . Правильная ссылка поделиться постом, добавлены новые переменные для ее обработки
  . Мелкие исправления
  . Поправлены bbcod 
  . Добавлена возможность вкл/выкл в настройках форума объединения сообщений в постах, а ткаже вкл/выкл вывода текста о том, кто отредактировал пост.
  . Добавлена фиксация 1 сообщения в постах в main_page.tpl
  . Полностью переделаны теги Обсудить на форуме (теперь имеет такое название и свои настройки)
  . Возможность выводить две кнопки Обсудить на форуме.
  . Добавлена возможность редактировать ИД форума или привязывать новость к форуму при редактировании публикации


В админ панель:
--------------------------------------------------------------------
В /engine/skins/default/tpl/news/add.tpl
Ищем:
			{% if flags['multicat.show'] %}
				<div class="card mb-4">
					<div class="card-header">{{ lang['editor.extcat'] }}</div>
					<div class="card-body">
						<div style="overflow: auto; height: 150px;">{{ extcat }}</div>
					</div>
				</div>
			{% endif %}
Ниже вставить:
			{% if (pluginIsActive('forum')) %}
				{{ add_forum }}
			{% endif %}
			
В /engine/skins/default/tpl/news/edit.tpl
Ищем
			<div class="card mb-4">
				<div class="card-header">{{ lang['editor.extcat'] }}</div>
				<div class="card-body">
					<div style="overflow: auto; height: 150px;">{{ extcat }}</div>
				</div>
			</div>
Ниже вставить:
			{% if (pluginIsActive('forum')) %}
				{{ edit_forum }}
			{% endif %}
			
В шаблоне темы сайта:
--------------------------------------------------------------------	
news.short.tpl, news.full.tpl доступен новые теги:
Для 1 кнопки
  . {topic_forum}                         - Отображает имя категории форума
  . {topic_forum_url}                      - Отображает ссылку на форум (показывается если у этой новости есть тема на форуме)
  . [topic_show][/topic_show]              - Отображает внутри если есть темы на форуме 
  . [not_topic_show]...[/not_topic_show]   - выводит содержания текста, если нет темы на форуме
  . {topic_forum_mesage}                   - выводит сообщения с форума (1 пост)
Для 2 кнопки
  . {discus_forum}                         - Отображает имя категории форума
  . {discus_forum_url}                     - Отображает ссылку на форум (показывается если у этой новости есть тема на форуме)
  . [discus_show][/discus_show]            - Отображает внутри если есть темы на форуме 
  . [not_discus_show]...[/not_discus_show] - выводит содержания текста, если нет темы на форуме

Данные кнопки определяют по какому тегу выводить категорию форума в публикации. При добавлении новости (если включен режим вторая кнопка Обсудить на форуме), то выбрать можно одну из них, при редактировании новости, можно создать привязку по этим двум кнопкам.


Данные форума можно выводить через callPlugin пример использования для main.tpl
-------------------
{{ callPlugin('forum.ShowListNews', {'limit': 12, 'temp' : 'show_news'}) }}
{{ callPlugin('forum.ShowTopics', {'limit': 12, 'temp' : 'show_topics'}) }}
{{ callPlugin('forum.ShowTopicsTop', {'limit': 12, 'temp' : 'show_topics_top'}) }}
{{ callPlugin('forum.ShowAUsers', {'limit': 12, 'temp' : 'show_a_users'}) }}
 

Вывод ошибок.
-------------------
в main_page.tpl шаблона форума (в самом конце):
 
{% if (global.user['status'] == 1) %}
{{ debug_queries }}
{{ debug_profiler }}
{% endif %}


Заметка :)
-------------------
plugin_rss_forum($params) и plugin_rss_feed_forum($params)
после show_main_page(false, $output, true);

$SUPRESS_TEMPLATE_SHOW = 1;
$SUPRESS_MAINBLOCK_SHOW = 1;
-------------------